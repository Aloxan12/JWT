{"version":3,"file":"static/js/259.656fe81e.chunk.js","mappings":"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","sources":["webpack://client/./src/pages/Posts/ui/Posts.module.scss?c94c","app/core/api/postApi.ts","pages/Posts/ui/containers/CreatePost/CreatePost.tsx","webpack://client/./src/pages/Posts/ui/containers/Post/Post.module.scss?0eab","webpack://client/./src/shared/ui/AppTrash/AppTrash.module.scss?1201","shared/ui/AppTrash/AppTrash.tsx","pages/Posts/ui/containers/Post/Post.tsx","pages/Posts/ui/containers/PostList/PostList.tsx","shared/lib/hooks/useDebounce.tsx","pages/Posts/ui/Posts.tsx"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"container\":\"Posts_container__fKaSN\",\"row\":\"Posts_row__ZN1Oi\",\"col\":\"Posts_col__O3tuq\",\"col-1\":\"Posts_col-1__pQJjt\",\"col-2\":\"Posts_col-2__qHYTd\",\"col-3\":\"Posts_col-3__jAP7F\",\"col-4\":\"Posts_col-4__dddLD\",\"col-5\":\"Posts_col-5__74WnE\",\"col-6\":\"Posts_col-6__qAlIa\",\"col-7\":\"Posts_col-7__an18j\",\"col-8\":\"Posts_col-8__1iz3t\",\"col-9\":\"Posts_col-9__gbuu0\",\"col-10\":\"Posts_col-10__lK9xS\",\"col-11\":\"Posts_col-11__W5YcE\",\"col-12\":\"Posts_col-12__neDSq\",\"col-xs-1\":\"Posts_col-xs-1__e1yU1\",\"col-xs-2\":\"Posts_col-xs-2__wRQ-a\",\"col-xs-3\":\"Posts_col-xs-3__Xm2nm\",\"col-xs-4\":\"Posts_col-xs-4__WVJcv\",\"col-xs-5\":\"Posts_col-xs-5__34SlK\",\"col-xs-6\":\"Posts_col-xs-6__WEPNq\",\"col-xs-7\":\"Posts_col-xs-7__3yVBo\",\"col-xs-8\":\"Posts_col-xs-8__H29PK\",\"col-xs-9\":\"Posts_col-xs-9__JANMt\",\"col-xs-10\":\"Posts_col-xs-10__ykcjD\",\"col-xs-11\":\"Posts_col-xs-11__2uBwK\",\"col-xs-12\":\"Posts_col-xs-12__gubIs\",\"col-sm-1\":\"Posts_col-sm-1__dZoL+\",\"col-sm-2\":\"Posts_col-sm-2__tQk2n\",\"col-sm-3\":\"Posts_col-sm-3__fFfQi\",\"col-sm-4\":\"Posts_col-sm-4__59j4N\",\"col-sm-5\":\"Posts_col-sm-5__t32gc\",\"col-sm-6\":\"Posts_col-sm-6__VFrQT\",\"col-sm-7\":\"Posts_col-sm-7__Ti88E\",\"col-sm-8\":\"Posts_col-sm-8__Bs91f\",\"col-sm-9\":\"Posts_col-sm-9__6iCse\",\"col-sm-10\":\"Posts_col-sm-10__atC40\",\"col-sm-11\":\"Posts_col-sm-11__F2GMa\",\"col-sm-12\":\"Posts_col-sm-12__cLfmN\",\"col-md-1\":\"Posts_col-md-1__KwG0H\",\"col-md-2\":\"Posts_col-md-2__ZGmX6\",\"col-md-3\":\"Posts_col-md-3__NHvfV\",\"col-md-4\":\"Posts_col-md-4__hzikR\",\"col-md-5\":\"Posts_col-md-5__yHC3H\",\"col-md-6\":\"Posts_col-md-6__d2kxY\",\"col-md-7\":\"Posts_col-md-7__D0sBM\",\"col-md-8\":\"Posts_col-md-8__ORorQ\",\"col-md-9\":\"Posts_col-md-9__fCbhP\",\"col-md-10\":\"Posts_col-md-10__Zd3Y9\",\"col-md-11\":\"Posts_col-md-11__VZ8DA\",\"col-md-12\":\"Posts_col-md-12__3la-V\",\"col-lg-1\":\"Posts_col-lg-1__sBQTu\",\"col-lg-2\":\"Posts_col-lg-2__jKl1h\",\"col-lg-3\":\"Posts_col-lg-3__Fdlkj\",\"col-lg-4\":\"Posts_col-lg-4__T5pSx\",\"col-lg-5\":\"Posts_col-lg-5__d0S9A\",\"col-lg-6\":\"Posts_col-lg-6__qQQuK\",\"col-lg-7\":\"Posts_col-lg-7__TLYda\",\"col-lg-8\":\"Posts_col-lg-8__Dxe9w\",\"col-lg-9\":\"Posts_col-lg-9__hEmJ2\",\"col-lg-10\":\"Posts_col-lg-10__ZBizq\",\"col-lg-11\":\"Posts_col-lg-11__MWxqh\",\"col-lg-12\":\"Posts_col-lg-12__wePit\",\"col-xl-1\":\"Posts_col-xl-1__lvc9a\",\"col-xl-2\":\"Posts_col-xl-2__Zb7Rt\",\"col-xl-3\":\"Posts_col-xl-3__XTpE6\",\"col-xl-4\":\"Posts_col-xl-4__+x69S\",\"col-xl-5\":\"Posts_col-xl-5__sapM9\",\"col-xl-6\":\"Posts_col-xl-6__zco2z\",\"col-xl-7\":\"Posts_col-xl-7__KtwOy\",\"col-xl-8\":\"Posts_col-xl-8__jTVoQ\",\"col-xl-9\":\"Posts_col-xl-9__f6akl\",\"col-xl-10\":\"Posts_col-xl-10__LEgHV\",\"col-xl-11\":\"Posts_col-xl-11__V0rvR\",\"col-xl-12\":\"Posts_col-xl-12__Php4p\",\"col-xxs-1\":\"Posts_col-xxs-1__oSUkJ\",\"col-xxs-2\":\"Posts_col-xxs-2__QnUiD\",\"col-xxs-3\":\"Posts_col-xxs-3__5KEpl\",\"col-xxs-4\":\"Posts_col-xxs-4__+z9UX\",\"col-xxs-5\":\"Posts_col-xxs-5__1R5Jx\",\"col-xxs-6\":\"Posts_col-xxs-6__B9Kwh\",\"col-xxs-7\":\"Posts_col-xxs-7__m8wxa\",\"col-xxs-8\":\"Posts_col-xxs-8__2wyh-\",\"col-xxs-9\":\"Posts_col-xxs-9__TfJFg\",\"col-xxs-10\":\"Posts_col-xxs-10__1M8hl\",\"col-xxs-11\":\"Posts_col-xxs-11__k11GX\",\"col-xxs-12\":\"Posts_col-xxs-12__bI3qL\",\"postBlock\":\"Posts_postBlock__TuvF-\",\"postsItems\":\"Posts_postsItems__6kXGQ\",\"postTrashBlock\":\"Posts_postTrashBlock__wmQS2\",\"postCreate\":\"Posts_postCreate__z5tCB\",\"postEditBlock\":\"Posts_postEditBlock__WKy92\"};","import { ICreatePost, IPost, IPostRequestDto, IPostsResponseDto } from './dto/PostDto';\nimport { authApi } from './authApi';\n\nexport const postApi = authApi.injectEndpoints({\n  endpoints: (build) => ({\n    getAllPosts: build.query<IPostsResponseDto, IPostRequestDto | void | null>({\n      query: (params) => ({\n        url: '/posts',\n        params: !!params ? params : {},\n      }),\n      providesTags: ['Posts', 'Users'],\n    }),\n    createPosts: build.mutation<IPost, ICreatePost>({\n      query: (params) => ({\n        url: '/posts',\n        method: 'POST',\n        body: params,\n      }),\n      invalidatesTags: ['Posts'],\n    }),\n    likePost: build.mutation<IPost, { id: string }>({\n      query: ({ id }) => ({\n        url: `/posts/${id}/like`,\n        method: 'PATCH',\n      }),\n      invalidatesTags: ['Posts'],\n    }),\n    deletePost: build.mutation<{ post: IPost; message: string; status: number }, { id: string }>({\n      query: ({ id }) => ({\n        url: `/posts/${id}`,\n        method: 'DELETE',\n      }),\n      invalidatesTags: ['Posts'],\n    }),\n  }),\n});\n\nexport const {\n  useGetAllPostsQuery,\n  useCreatePostsMutation,\n  useLikePostMutation,\n  useDeletePostMutation,\n} = postApi;\n","import { AppTextarea } from '../../../../../shared/ui/AppTextarea/AppTextarea';\nimport { AppButton } from '../../../../../shared/ui/AppButton/AppButton';\nimport { Flex } from '../../../../../shared/ui/Flex/Flex';\nimport React, { useState } from 'react';\nimport {\n  ToastWrapper,\n  ToastWrapperType,\n} from '../../../../../Common/Components/ToastWrapper/ToastWrapper';\nimport { useCreatePostsMutation } from '../../../../../app/core/api/postApi';\nimport moment from 'moment';\nimport { useSelector } from 'react-redux';\nimport { RootState } from '../../../../../app/core/redux/store';\nimport { IUser } from '../../../../../app/core/api/dto/UserDto';\n\ninterface CreatePostProps {\n  setCurrentPage: (page: number) => void;\n}\n\nexport const CreatePost = ({ setCurrentPage }: CreatePostProps) => {\n  const user = useSelector<RootState, IUser | null>((state) => state.auth.user);\n  const [postText, setPostText] = useState('');\n\n  const [createPost, { isLoading: isLoadingCreate }] = useCreatePostsMutation();\n\n  const createPostHandler = () => {\n    if (user && postText !== '') {\n      createPost({ author: user.id, postText, publicDate: moment(new Date()).toISOString() }).then(\n        () => {\n          setPostText('');\n          setCurrentPage(1);\n          ToastWrapper({\n            msg: 'Пост опубликован'.replace(/\"/g, ''),\n            type: ToastWrapperType.success,\n          });\n        }\n      );\n    }\n  };\n\n  return (\n    <Flex direction=\"column\" align=\"start\" max gap=\"16\">\n      <AppTextarea value={postText} onChange={setPostText} fullWidth rows=\"3\" />\n      <AppButton\n        title=\"Опубликовать\"\n        onClick={createPostHandler}\n        theme=\"full-bg\"\n        disabled={!postText}\n        isLoading={isLoadingCreate}\n      />\n    </Flex>\n  );\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"postsItem\":\"Post_postsItem__WtXR8\",\"postDateBlock\":\"Post_postDateBlock__dkPvd\",\"email\":\"Post_email__RlJ5t\",\"postLikeBlock\":\"Post_postLikeBlock__pPpJ5\",\"likeActive\":\"Post_likeActive__D9EwX\",\"postsItemContent\":\"Post_postsItemContent__pyt4f\"};","// extracted by mini-css-extract-plugin\nexport default {\"trash\":\"AppTrash_trash__kZGY9\",\"small\":\"AppTrash_small__abggq\",\"medium\":\"AppTrash_medium__Wbl99\",\"big\":\"AppTrash_big__1D8jV\",\"trashModelContent\":\"AppTrash_trashModelContent__dpjKk\"};","import React, { useState } from 'react';\nimport trashIco from '../../../utils/images/trash.png';\nimport cls from './AppTrash.module.scss';\nimport { AppPhoto } from '../AppPhoto/AppPhoto';\nimport { AppModal } from '../AppModal/Modal';\nimport { classNames } from '../../lib/classNames/classNames';\nimport { AppButton } from '../AppButton/AppButton';\nimport { Flex } from '../Flex/Flex';\n\ninterface IAppTrashProps {\n  size?: 'big' | 'medium' | 'small';\n  deleteHandler: (onClose?: () => void) => void;\n  text?: string;\n}\n\nexport const AppTrash = ({ size = 'big', deleteHandler, text }: IAppTrashProps) => {\n  const [active, setActive] = useState<boolean>(false);\n\n  const onOpen = () => setActive(true);\n  const onClose = () => setActive(false);\n  return (\n    <React.Fragment>\n      <AppPhoto\n        src={trashIco}\n        alt=\"корзина\"\n        className={classNames(cls.trash, {}, [cls[size]])}\n        onClick={onOpen}\n      />\n      <AppModal isOpen={active} onClose={onClose} title=\"Предупреждение\" lazy>\n        <Flex direction=\"column\" gap=\"16\" align=\"start\">\n          <div>{text || 'Удалить?'}</div>\n          <Flex justify=\"between\" max>\n            <AppButton onClick={onClose} title=\"нет\" theme=\"full-bg\" />\n            <AppButton\n              onClick={() => {\n                deleteHandler(onClose);\n              }}\n              theme=\"full-bg\"\n              title=\"да\"\n            />\n          </Flex>\n        </Flex>\n      </AppModal>\n    </React.Fragment>\n  );\n};\n","import React, { useCallback } from 'react';\nimport cls from './Post.module.scss';\nimport moment from 'moment';\nimport { useDeletePostMutation, useLikePostMutation } from '../../../../../app/core/api/postApi';\nimport { contentToHtml } from '../../../../../utils/helpers';\nimport { AppTrash } from '../../../../../shared/ui/AppTrash/AppTrash';\nimport {\n  ToastWrapper,\n  ToastWrapperType,\n} from '../../../../../Common/Components/ToastWrapper/ToastWrapper';\nimport { IPost } from '../../../../../app/core/api/dto/PostDto';\nimport likePhoto from '../../../../../utils/images/like.png';\nimport { AppAvatar } from '../../../../../shared/ui/AppAvatar/AppAvatar';\nimport { Flex } from '../../../../../shared/ui/Flex/Flex';\nimport { AppText } from '../../../../../shared/ui/AppText/AppText';\nimport { AppPhoto } from '../../../../../shared/ui/AppPhoto/AppPhoto';\nimport { classNames, Mods } from '../../../../../shared/lib/classNames/classNames';\n\ninterface IPostProps {\n  isAdmin: boolean;\n  post: IPost;\n  setCurrentPage: (value: number) => void;\n}\n\nexport const Post = ({ post, setCurrentPage, isAdmin }: IPostProps) => {\n  const [deletePost] = useDeletePostMutation();\n  const [likePost] = useLikePostMutation();\n\n  const likePostHandler = useCallback(() => {\n    likePost({ id: post.id });\n  }, [post]);\n\n  const deletePostHandler = (onClose?: () => void) => {\n    deletePost({ id: post.id }).then((res) => {\n      const { data } = res as { data: { status: number; message: string; post: IPost } };\n      if (data.status === 204) {\n        setCurrentPage(1);\n        ToastWrapper({\n          msg: data.message.replace(/\"/g, ''),\n          type: ToastWrapperType.info,\n        });\n        onClose?.();\n      }\n    });\n  };\n\n  const modsLike: Mods = {\n    [cls.likeActive]: post.isLike,\n  };\n\n  return (\n    <li className={cls.postsItem}>\n      <Flex max justify=\"between\">\n        <Flex gap=\"8\">\n          <AppAvatar src={post.author?.avatar || ''} />\n          <AppText\n            text={post.author.email}\n            color=\"violet\"\n            bold=\"600\"\n            isEllipsis\n            className={cls.email}\n          />\n        </Flex>\n        <Flex gap=\"8\">\n          <div className={classNames(cls.postLikeBlock, modsLike, [])} onClick={likePostHandler}>\n            <AppPhoto src={likePhoto} alt=\"like\" width={20} height={20} />\n            {post.likeCount}\n          </div>\n          {isAdmin && (\n            <div className={cls.postTrashBlock}>\n              <AppTrash\n                deleteHandler={deletePostHandler}\n                size={'medium'}\n                text=\"Вы действительно хотите удалить данный пост?\"\n              />\n            </div>\n          )}\n        </Flex>\n      </Flex>\n      <div className={cls.postDateBlock}>\n        <span>\n          <span>Опубликовано:</span>{' '}\n          {moment(post.publicDate).format('DD-MM-YYYY') || 'Дата не зафикирована'}\n        </span>\n      </div>\n      <div className={cls.postsItemContent}>{contentToHtml(post.postText)}</div>\n    </li>\n  );\n};\n","import React, { useEffect, useState } from 'react';\nimport cls from '../../Posts.module.scss';\nimport { IPost } from '../../../../../app/core/api/dto/PostDto';\nimport { Post } from '../Post/Post';\nimport { useGetAllPostsQuery } from '../../../../../app/core/api/postApi';\nimport { throttle } from '../../../../../shared/lib/hooks/useDebounce';\nimport { AppLoader } from '../../../../../Common/Components/AppLoader/AppLoader';\nimport { useAppSelector } from '../../../../../app/core/redux/store';\nimport { userIsAdmin } from '../../../../../app/core/redux/Reducers/auth/selectors';\n\ninterface PostListProps {\n  currentPage: number;\n  setCurrentPage: React.Dispatch<React.SetStateAction<number>>;\n}\n\nexport const PostList = ({ currentPage, setCurrentPage }: PostListProps) => {\n  const [fetching, setFetching] = useState<boolean>(false);\n  const isAdmin = useAppSelector(userIsAdmin);\n  const [posts, setPosts] = useState<IPost[]>([]);\n  const limit = 10;\n  const {\n    data: postsData,\n    isLoading: isLoadingList,\n    isFetching: isFetchingList,\n  } = useGetAllPostsQuery({ limit, page: currentPage });\n\n  useEffect(() => {\n    if (!!postsData && fetching && currentPage !== 1) {\n      setPosts((prevState) => [...prevState, ...postsData.results]);\n    } else if (!!postsData) {\n      setPosts(postsData.results);\n    }\n    setFetching(false);\n  }, [postsData]);\n\n  useEffect(() => {\n    if (fetching && postsData && postsData.count > limit * currentPage) {\n      setCurrentPage((prev) => prev + 1);\n    }\n  }, [fetching]);\n\n  const scrollHandler = (e: any) => {\n    const { scrollTop, scrollHeight } = e.target.documentElement;\n    if (scrollHeight - (scrollTop + window.innerHeight) < 50) {\n      setFetching(true);\n    }\n  };\n\n  const throttleScrollHandler = throttle(scrollHandler, 300);\n\n  useEffect(() => {\n    document.addEventListener('scroll', throttleScrollHandler);\n    return () => document.removeEventListener('scroll', throttleScrollHandler);\n  }, []);\n\n  return (\n    <>\n      {(isFetchingList || isLoadingList) && <AppLoader />}\n      <ul className={cls.postsItems}>\n        {posts.map((post: IPost) => {\n          return (\n            <Post isAdmin={isAdmin} post={post} key={post.id} setCurrentPage={setCurrentPage} />\n          );\n        })}\n      </ul>\n    </>\n  );\n};\n","import { useEffect, useState } from 'react';\n\nexport function useDebounce<T>(value: T, delay: number) {\n  const [debouncedValue, setDebouncedValue] = useState(value);\n\n  useEffect(() => {\n    const handler = setTimeout(() => {\n      setDebouncedValue(value);\n    }, delay);\n    return () => {\n      clearTimeout(handler);\n    };\n  }, [value]);\n\n  return debouncedValue;\n}\n\nexport function throttle<T>(callback: T, delay: number) {\n  let isWaiting = false;\n  let savedArgs: any[] | null = null;\n  let savedThis: null | any = null;\n  return function wrapper(this: any, ...args: any) {\n    if (isWaiting) {\n      savedArgs = args;\n      savedThis = this;\n      return;\n    }\n    // @ts-ignorer\n    callback.apply(this, args);\n    isWaiting = true;\n    setTimeout(() => {\n      isWaiting = false;\n      if (savedThis) {\n        wrapper.apply(savedThis, savedArgs!);\n        savedThis = null;\n        savedArgs = args;\n      }\n    }, delay);\n  };\n}\n","import React, { useState } from 'react';\nimport styles from './Posts.module.scss';\nimport { AppTitle } from '../../../shared/ui/AppTitle/AppTitle';\nimport { AppCard } from '../../../shared/ui/AppCard/AppCard';\nimport { CreatePost } from './containers/CreatePost/CreatePost';\nimport { PostList } from './containers/PostList/PostList';\n\nconst Posts = () => {\n  const [currentPage, setCurrentPage] = useState<number>(1);\n\n  return (\n    <AppCard classNameContent={styles.postBlock} max boxShadow withoutBorder>\n      <AppTitle title=\"Посты\" titleTag=\"h1\" align=\"center\" />\n      <CreatePost setCurrentPage={setCurrentPage} />\n      <PostList currentPage={currentPage} setCurrentPage={setCurrentPage} />\n    </AppCard>\n  );\n};\n\nexport default Posts;\n"],"names":["postApi","authApi","endpoints","build","getAllPosts","query","params","url","providesTags","createPosts","mutation","method","body","invalidatesTags","likePost","id","deletePost","useGetAllPostsQuery","useCreatePostsMutation","useLikePostMutation","useDeletePostMutation","CreatePost","setCurrentPage","user","useSelector","state","auth","useState","postText","setPostText","createPost","isLoadingCreate","isLoading","Flex","direction","align","max","gap","AppTextarea","value","onChange","fullWidth","rows","AppButton","title","onClick","author","publicDate","moment","Date","toISOString","then","ToastWrapper","msg","replace","type","ToastWrapperType","theme","disabled","AppTrash","size","deleteHandler","text","active","setActive","onClose","AppPhoto","src","trashIco","alt","className","classNames","cls","isOpen","lazy","justify","Post","post","isAdmin","likePostHandler","useCallback","modsLike","isLike","AppAvatar","avatar","AppText","email","color","bold","isEllipsis","likePhoto","width","height","likeCount","res","data","status","message","format","contentToHtml","PostList","currentPage","fetching","setFetching","useAppSelector","userIsAdmin","posts","setPosts","limit","page","postsData","isLoadingList","isFetchingList","isFetching","useEffect","prevState","results","count","prev","throttleScrollHandler","callback","delay","isWaiting","savedArgs","savedThis","wrapper","args","this","apply","setTimeout","throttle","e","target","documentElement","scrollTop","scrollHeight","window","innerHeight","document","addEventListener","removeEventListener","AppLoader","map","AppCard","classNameContent","styles","boxShadow","withoutBorder","AppTitle","titleTag"],"sourceRoot":""}