"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[994],{5078:function(e,t,n){n.r(t),n.d(t,{default:function(){return re}});var s,i=n(9439),r=n(2791),a="Posts_postBlock__TuvF-",l="Posts_postsItems__6kXGQ",o=n(1088),c=n(4782),u=n(9744),d=n(361),p=n(4687),f=n(429),m=n(8649).iJ.injectEndpoints({endpoints:function(e){return{getAllPosts:e.query({query:function(e){return{url:"/posts",params:e||{}}},providesTags:["Posts","Users"]}),createPosts:e.mutation({query:function(e){return{url:"/posts",method:"POST",body:e}},invalidatesTags:["Posts"]}),likePost:e.mutation({query:function(e){var t=e.id;return{url:"/posts/".concat(t,"/like"),method:"PATCH"}},invalidatesTags:["Posts"]}),deletePost:e.mutation({query:function(e){var t=e.id;return{url:"/posts/".concat(t),method:"DELETE"}},invalidatesTags:["Posts"]})}}}),h=m.useGetAllPostsQuery,g=m.useCreatePostsMutation,v=m.useLikePostMutation,_=m.useDeletePostMutation,k=n(2426),j=n.n(k),x=n(2597),b=n(3329),y=function(e){var t=e.setCurrentPage,n=(0,x.v9)((function(e){return e.auth.user})),s=(0,r.useState)(""),a=(0,i.Z)(s,2),l=a[0],o=a[1],c=g(),m=(0,i.Z)(c,2),h=m[0],v=m[1].isLoading;return(0,b.jsxs)(p.k,{direction:"column",align:"start",max:!0,gap:"16",children:[(0,b.jsx)(u.W,{value:l,onChange:o,fullWidth:!0,rows:"3"}),(0,b.jsx)(d.J,{title:"\u041e\u043f\u0443\u0431\u043b\u0438\u043a\u043e\u0432\u0430\u0442\u044c",onClick:function(){n&&""!==l&&h({author:n.id,postText:l,publicDate:j()(new Date).toISOString()}).then((function(){o(""),t(1),(0,f.y)({msg:"\u041f\u043e\u0441\u0442 \u043e\u043f\u0443\u0431\u043b\u0438\u043a\u043e\u0432\u0430\u043d".replace(/"/g,""),type:f.p.success})}))},theme:"full-bg",disabled:!l,isLoading:v})]})},C=n(3433),P=n(4942),w={postsItem:"Post_postsItem__WtXR8",postDateBlock:"Post_postDateBlock__dkPvd",email:"Post_email__RlJ5t",postLikeBlock:"Post_postLikeBlock__pPpJ5",likeActive:"Post_likeActive__D9EwX",postsItemContent:"Post_postsItemContent__pyt4f"},T=n(7460),E=n.p+"static/media/trash.ff6de8f4b8e11b0d507d.png",A={trash:"AppTrash_trash__kZGY9",small:"AppTrash_small__abggq",medium:"AppTrash_medium__Wbl99",big:"AppTrash_big__1D8jV",trashModelContent:"AppTrash_trashModelContent__dpjKk"},M=n(736),Z=n(4164),N=function(e){var t=e.children,n=e.element,s=void 0===n?document.body:n;return(0,Z.createPortal)(t,s)},O="Modal_Modal__d4siT",L="Modal_overlay__rTWcU",S="Modal_content__aydgw",B="Modal_titleBlock__ubmA1",D="Modal_title__ozuVG",I="Modal_icoCloseBlock__J-qnl",J="Modal_opened__NZhRU",q="Modal_isClosing__9dCXe",F=n(3546),R=function(e){e.stopPropagation()},W=n(2225),z=["title","titleId"];function G(){return G=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},G.apply(this,arguments)}function H(e,t){if(null==e)return{};var n,s,i=function(e,t){if(null==e)return{};var n,s,i={},r=Object.keys(e);for(s=0;s<r.length;s++)n=r[s],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(s=0;s<r.length;s++)n=r[s],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Y(e,t){var n=e.title,i=e.titleId,a=H(e,z);return r.createElement("svg",G({width:32,height:32,viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":i},a),n?r.createElement("title",{id:i},n):null,s||(s=r.createElement("path",{d:"M5 5L26.495 26.495M26.495 5L5 26.495",stroke:"#F6F6F8",strokeWidth:4})))}var X=r.forwardRef(Y),Q=(n.p,function(e){var t,n=e.className,s=e.children,a=e.isOpen,l=e.onClose,o=e.lazy,c=e.title,u=e.icoClose,d=(0,r.useState)(!1),f=(0,i.Z)(d,2),m=f[0],h=f[1],g=(0,r.useState)(!1),v=(0,i.Z)(g,2),_=v[0],k=v[1],j=(0,r.useRef)();(0,r.useEffect)((function(){a&&k(!0)}),[a]);var x=(0,r.useCallback)((function(){l&&(h(!0),j.current=setTimeout((function(){l(),h(!1)}),300))}),[l]),y=(0,r.useCallback)((function(e){"Escape"===e.key&&x()}),[x]);(0,r.useEffect)((function(){return a&&window.addEventListener("keydown",y),function(){clearTimeout(j.current),window.removeEventListener("keydown",y)}}),[a,y]);var C=(t={},(0,P.Z)(t,J,a),(0,P.Z)(t,"app-modal",a),(0,P.Z)(t,q,m),t);return o&&!_?null:(0,b.jsx)(N,{children:(0,b.jsx)("div",{className:(0,F.A)(O,C,[n]),children:(0,b.jsx)("div",{className:L,onClick:x,children:(0,b.jsxs)("div",{className:S,onClick:R,children:[c&&(0,b.jsxs)(p.k,{align:"center",gap:"32",justify:"between",className:B,children:[(0,b.jsx)("span",{className:D,children:c}),u&&(0,b.jsx)(p.k,{align:"center",gap:"8",children:(0,b.jsx)(p.k,{justify:"center",align:"center",className:I,onClick:x,children:(0,b.jsx)(W.A,{svg:X})})})]}),s]})})})})}),U=function(e){var t=e.size,n=void 0===t?"big":t,s=e.deleteHandler,a=e.text,l=(0,r.useState)(!1),o=(0,i.Z)(l,2),c=o[0],u=o[1],f=function(){return u(!1)};return(0,b.jsxs)(r.Fragment,{children:[(0,b.jsx)(M.e,{src:E,alt:"\u043a\u043e\u0440\u0437\u0438\u043d\u0430",className:(0,F.A)(A.trash,{},[A[n]]),onClick:function(){return u(!0)}}),(0,b.jsx)(Q,{isOpen:c,onClose:f,title:"\u041f\u0440\u0435\u0434\u0443\u043f\u0440\u0435\u0436\u0434\u0435\u043d\u0438\u0435",lazy:!0,children:(0,b.jsxs)(p.k,{direction:"column",gap:"16",align:"start",children:[(0,b.jsx)("div",{children:a||"\u0423\u0434\u0430\u043b\u0438\u0442\u044c?"}),(0,b.jsxs)(p.k,{justify:"between",max:!0,children:[(0,b.jsx)(d.J,{onClick:f,title:"\u043d\u0435\u0442",theme:"full-bg"}),(0,b.jsx)(d.J,{onClick:function(){s(f)},theme:"full-bg",title:"\u0434\u0430"})]})]})})]})},V=n.p+"static/media/like.5f22da937dbad35f573f.png",K=n(6070),$=n(4634),ee=function(e){var t,n=e.post,s=e.setCurrentPage,a=e.isAdmin,l=_(),o=(0,i.Z)(l,1)[0],c=v(),u=(0,i.Z)(c,1)[0],d=(0,r.useCallback)((function(){u({id:n.id})}),[n]),m=(0,P.Z)({},w.likeActive,n.isLike);return(0,b.jsxs)("li",{className:w.postsItem,children:[(0,b.jsxs)(p.k,{max:!0,justify:"between",children:[(0,b.jsxs)(p.k,{gap:"8",children:[(0,b.jsx)(K.J,{src:(null===(t=n.author)||void 0===t?void 0:t.avatar)||""}),(0,b.jsx)($.K,{text:n.author.email,color:"violet",bold:"600",isEllipsis:!0,className:w.email})]}),(0,b.jsxs)(p.k,{gap:"8",children:[(0,b.jsxs)("div",{className:(0,F.A)(w.postLikeBlock,m,[]),onClick:d,children:[(0,b.jsx)(M.e,{src:V,alt:"like",width:20,height:20}),n.likeCount]}),a&&(0,b.jsx)("div",{className:w.postTrashBlock,children:(0,b.jsx)(U,{deleteHandler:function(e){o({id:n.id}).then((function(t){var n=t.data;204===n.status&&(s(1),(0,f.y)({msg:n.message.replace(/"/g,""),type:f.p.info}),null===e||void 0===e||e())}))},size:"medium",text:"\u0412\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0439 \u043f\u043e\u0441\u0442?"})})]})]}),(0,b.jsx)("div",{className:w.postDateBlock,children:(0,b.jsxs)("span",{children:[(0,b.jsx)("span",{children:"\u041e\u043f\u0443\u0431\u043b\u0438\u043a\u043e\u0432\u0430\u043d\u043e:"})," ",j()(n.publicDate).format("DD-MM-YYYY")||"\u0414\u0430\u0442\u0430 \u043d\u0435 \u0437\u0430\u0444\u0438\u043a\u0438\u0440\u043e\u0432\u0430\u043d\u0430"]})}),(0,b.jsx)("div",{className:w.postsItemContent,children:(0,T.RV)(n.postText)})]})};var te=n(3644),ne=n(8071),se=n(2035),ie=function(e){var t=e.currentPage,n=e.setCurrentPage,s=(0,r.useState)(!1),a=(0,i.Z)(s,2),o=a[0],c=a[1],u=(0,ne.CG)(se.s),d=(0,r.useState)([]),p=(0,i.Z)(d,2),f=p[0],m=p[1],g=h({limit:10,page:t}),v=g.data,_=g.isLoading,k=g.isFetching;(0,r.useEffect)((function(){v&&o&&1!==t?m((function(e){return[].concat((0,C.Z)(e),(0,C.Z)(v.results))})):v&&m(v.results),c(!1)}),[v]),(0,r.useEffect)((function(){o&&v&&v.count>10*t&&n((function(e){return e+1}))}),[o]);var j=function(e,t){var n=!1,s=null,i=null;return function r(){for(var a=arguments.length,l=new Array(a),o=0;o<a;o++)l[o]=arguments[o];if(n)return s=l,void(i=this);e.apply(this,l),n=!0,setTimeout((function(){n=!1,i&&(r.apply(i,s),i=null,s=l)}),t)}}((function(e){var t=e.target.documentElement,n=t.scrollTop;t.scrollHeight-(n+window.innerHeight)<50&&c(!0)}),300);return(0,r.useEffect)((function(){return document.addEventListener("scroll",j),function(){return document.removeEventListener("scroll",j)}}),[]),(0,b.jsxs)(b.Fragment,{children:[(k||_)&&(0,b.jsx)(te.Q,{}),(0,b.jsx)("ul",{className:l,children:f.map((function(e){return(0,b.jsx)(ee,{isAdmin:u,post:e,setCurrentPage:n},e.id)}))})]})},re=function(){var e=(0,r.useState)(1),t=(0,i.Z)(e,2),n=t[0],s=t[1];return(0,b.jsxs)(c.C,{classNameContent:a,max:!0,boxShadow:!0,withoutBorder:!0,children:[(0,b.jsx)(o.d,{title:"\u041f\u043e\u0441\u0442\u044b",titleTag:"h1",align:"center"}),(0,b.jsx)(y,{setCurrentPage:s}),(0,b.jsx)(ie,{currentPage:n,setCurrentPage:s})]})}}}]);
//# sourceMappingURL=994.8d8db969.chunk.js.map